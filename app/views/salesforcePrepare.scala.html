@()(implicit lang: Lang)

@base(Messages("generateSalesforceObject")) {
<link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/jquery.formbuilder.css")">
<script src="@routes.Assets.at("javascripts/ext/validation/jquery.validate.js")" type="text/javascript"></script>
<script src="@routes.Assets.at("javascripts/jquery.formbuilder.js")" type="text/javascript"></script>
<script src="@routes.Assets.at("javascripts/ext/validation/localization/messages_ja.js")" type="text/javascript"></script>
<h1 class="dialog-h1">@Messages("generateSalesforceObject")</h1>
<div>
	<form action="/salesforce/create" method="POST">
		<button type="button" id="submit">@Messages("generate")</button>
	</form>
</div>
<script>
$(function() {
	var json = sessionStorage.getItem("template"),
		form = $("form").formbuilder({
		"title" : "@Messages("objectInfo")",
		"errorBreak" : true,
		"items" : {
			"name" : {
				"label" : "@Messages("objectName")",
				"required" : true,
				"type" : "text"
			},
			"label" : {
				"label" : "@Messages("label")",
				"type" : "text"
			},
			"description" : {
				"label" : "@Messages("description")",
				"type" : "textarea",
				"cols" : 40,
				"rows" : 5
			},
			"json" : {
				"type" : "hidden",
				"value" : json
			}
		}
	});
	$("#submit").click(function() {
		if (form.validate()) {
			$.ajax({
				"url" : "/salesforce/create",
				"type" : "POST",
				"data" : form.getJson(),
				"success" : function(data) {
					if (data == "OK") {
						alert("@Messages("finishGenerate")");
						window.close();
					} else {
						alert(data);
					}
				}
			});
		}
	});
});
</script>
}
